# proxmox_cluster_tasks
proxmox cluster automatic tasks helper

## API Reference
- Usage of Proxmox VE API : https://pve.proxmox.com/wiki/Proxmox_VE_API
- Proxmox VE API Viewer: https://pve.proxmox.com/pve-docs/api-viewer


## Debug
### Debug API
<details>
<summary>src/cluster_tasks/ext_api.py</summary>

```commandline
ExtApi enter
BackendHTTP Enter
HTTP Client connecting
Mapping ha_groups to BackendHttpHAGroups
method='GET' entry_point='/api2/json/cluster/ha/groups' data=None params=None
{'result': {'data': [{'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c05:30,c04:50,c03:40', 'group': 'gr-03-04f-05', 'nofailback': 0}, {'type': 'group', 'nodes': 'c01:30,c03:50,c02:40', 'nofailback': 0, 'group': 'gr-01-02-03f', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'type': 'group', 'nofailback': 0, 'group': 'gr-02f-03-04', 'nodes': 'c03:40,c04:30,c02:50', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'group': 'gr-04f-05-06', 'nofailback': 0, 'nodes': 'c04:50,c05:40,c06:30'}, {'nofailback': 0, 'group': 'gr-04-05-06f', 'nodes': 'c04:30,c06:50,c05:40', 'type': 'group', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'nofailback': 0, 'group': 'gr-06-07-08f', 'nodes': 'c08:50,c07:40,c06:30'}, {'nodes': 'c06:40,c05:30,c07:50', 'nofailback': 0, 'group': 'gr-05-06-07f', 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'group': 'gr-01f-02-03', 'nofailback': 0, 'nodes': 'c01:50,c02:40,c03:30', 'type': 'group', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'group': 'test-gr-02-03f-04', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'nodes': 'c03,c04,c02', 'type': 'group'}, {'type': 'group', 'group': 'gr-01-02f-03', 'nofailback': 0, 'nodes': 'c03:30,c01:40,c02:50', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'nodes': 'c03:30,c04:40,c05:50', 'nofailback': 0, 'group': 'gr-03-04-05f', 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'type': 'group', 'group': 'gr-04-05f-06', 'nofailback': 0, 'nodes': 'c06:30,c04:40,c05:50', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'nofailback': 0, 'group': 'gr-06-07f-08', 'nodes': 'c07:50,c06:40,c08:30', 'type': 'group'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c07:30,c06:40,c05:50', 'group': 'gr-05f-06-07', 'nofailback': 0}, {'nodes': 'c07:40,c08:30,c06:50', 'group': 'gr-06f-07-08', 'nofailback': 0, 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c03:40,c02:30,c04:50', 'group': 'gr-02-03-04f', 'nofailback': 0, 'type': 'group'}, {'type': 'group', 'nofailback': 0, 'group': 'gr-05-06f-07', 'nodes': 'c07:30,c06:50,c05:40', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'nofailback': 0, 'group': 'gr-02-03f-04', 'nodes': 'c04:30,c02:40,c03:50', 'type': 'group', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'type': 'group', 'nodes': 'c05:30,c04:40,c03:50', 'group': 'gr-03f-04-05', 'nofailback': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}]}, 'status_code': 200}
method='GET' entry_point='/api2/json/cluster/ha/groups' data=None params=None
{'result': {'data': [{'nofailback': 0, 'group': 'gr-01-02-03f', 'nodes': 'c02:40,c03:50,c01:30', 'type': 'group', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'nofailback': 0, 'group': 'gr-03-04f-05', 'nodes': 'c03:40,c05:30,c04:50'}, {'type': 'group', 'nodes': 'c06:50,c05:40,c04:30', 'nofailback': 0, 'group': 'gr-04-05-06f', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'group': 'gr-06-07-08f', 'nofailback': 0, 'nodes': 'c08:50,c06:30,c07:40'}, {'nodes': 'c04:50,c05:40,c06:30', 'nofailback': 0, 'group': 'gr-04f-05-06', 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'group': 'gr-02f-03-04', 'nofailback': 0, 'nodes': 'c02:50,c04:30,c03:40', 'type': 'group'}, {'nodes': 'c07:50,c05:30,c06:40', 'group': 'gr-05-06-07f', 'nofailback': 0, 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'nodes': 'c02,c04,c03', 'group': 'test-gr-02-03f-04'}, {'type': 'group', 'nodes': 'c02:50,c03:30,c01:40', 'nofailback': 0, 'group': 'gr-01-02f-03', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'type': 'group', 'nodes': 'c01:50,c02:40,c03:30', 'nofailback': 0, 'group': 'gr-01f-02-03', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'type': 'group', 'nofailback': 0, 'group': 'gr-03-04-05f', 'nodes': 'c05:50,c03:30,c04:40', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'nofailback': 0, 'group': 'gr-05f-06-07', 'nodes': 'c05:50,c07:30,c06:40'}, {'type': 'group', 'group': 'gr-04-05f-06', 'nofailback': 0, 'nodes': 'c04:40,c06:30,c05:50', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c07:50,c06:40,c08:30', 'nofailback': 0, 'group': 'gr-06-07f-08'}, {'group': 'gr-06f-07-08', 'nofailback': 0, 'nodes': 'c07:40,c08:30,c06:50', 'type': 'group', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'nofailback': 0, 'group': 'gr-02-03-04f', 'nodes': 'c03:40,c02:30,c04:50'}, {'type': 'group', 'nodes': 'c04:30,c03:50,c02:40', 'group': 'gr-02-03f-04', 'nofailback': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c05:30,c04:40,c03:50', 'nofailback': 0, 'group': 'gr-03f-04-05', 'type': 'group'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c05:40,c06:50,c07:30', 'nofailback': 0, 'group': 'gr-05-06f-07', 'type': 'group'}]}, 'status_code': 200}
BackendHTTP Exit
BackendHTTP HTTP Client closed
ExtApi exit

ExtApiAsync aenter
BackendAsyncHTTP Enter
HTTP Client async connecting
Mapping ha_groups to BackendAsyncHttpHAGroups
method='GET' entry_point='/api2/json/cluster/ha/groups' data=None params=None
{'result': {'data': [{'type': 'group', 'nofailback': 0, 'group': 'gr-05f-06-07', 'nodes': 'c05:50,c06:40,c07:30', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'type': 'group', 'nodes': 'c04:40,c06:30,c05:50', 'group': 'gr-04-05f-06', 'nofailback': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'nodes': 'c08:30,c06:40,c07:50', 'group': 'gr-06-07f-08', 'nofailback': 0, 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c05:50,c04:40,c03:30', 'nofailback': 0, 'group': 'gr-03-04-05f'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c04:30,c02:40,c03:50', 'group': 'gr-02-03f-04', 'nofailback': 0}, {'nodes': 'c04:40,c03:50,c05:30', 'group': 'gr-03f-04-05', 'nofailback': 0, 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'nodes': 'c07:30,c05:40,c06:50', 'nofailback': 0, 'group': 'gr-05-06f-07', 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'group': 'gr-06f-07-08', 'nofailback': 0, 'nodes': 'c06:50,c08:30,c07:40'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c04:50,c02:30,c03:40', 'group': 'gr-02-03-04f', 'nofailback': 0}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'group': 'gr-04-05-06f', 'nofailback': 0, 'nodes': 'c04:30,c05:40,c06:50'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c08:50,c06:30,c07:40', 'group': 'gr-06-07-08f', 'nofailback': 0, 'type': 'group'}, {'type': 'group', 'nofailback': 0, 'group': 'gr-02f-03-04', 'nodes': 'c04:30,c03:40,c02:50', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c04:50,c06:30,c05:40', 'nofailback': 0, 'group': 'gr-04f-05-06'}, {'nofailback': 0, 'group': 'gr-01-02-03f', 'nodes': 'c01:30,c02:40,c03:50', 'type': 'group', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c04:50,c05:30,c03:40', 'nofailback': 0, 'group': 'gr-03-04f-05', 'type': 'group'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'nodes': 'c02,c04,c03', 'group': 'test-gr-02-03f-04', 'type': 'group'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c03:30,c01:40,c02:50', 'group': 'gr-01-02f-03', 'nofailback': 0, 'type': 'group'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c01:50,c02:40,c03:30', 'nofailback': 0, 'group': 'gr-01f-02-03'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c07:50,c05:30,c06:40', 'group': 'gr-05-06-07f', 'nofailback': 0}]}, 'status_code': 200}
method='GET' entry_point='/api2/json/cluster/ha/groups' data=None params=None
{'result': {'data': [{'nofailback': 0, 'group': 'gr-02-03f-04', 'nodes': 'c02:40,c03:50,c04:30', 'type': 'group', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'nodes': 'c05:30,c03:50,c04:40', 'group': 'gr-03f-04-05', 'nofailback': 0, 'type': 'group', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'type': 'group', 'group': 'gr-05-06f-07', 'nofailback': 0, 'nodes': 'c05:40,c06:50,c07:30'}, {'type': 'group', 'nofailback': 0, 'group': 'gr-02-03-04f', 'nodes': 'c04:50,c02:30,c03:40', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c08:30,c07:40,c06:50', 'nofailback': 0, 'group': 'gr-06f-07-08', 'type': 'group'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c06:40,c07:30,c05:50', 'group': 'gr-05f-06-07', 'nofailback': 0}, {'type': 'group', 'nodes': 'c08:30,c07:50,c06:40', 'group': 'gr-06-07f-08', 'nofailback': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c05:50,c06:30,c04:40', 'group': 'gr-04-05f-06', 'nofailback': 0, 'type': 'group'}, {'group': 'gr-03-04-05f', 'nofailback': 0, 'nodes': 'c05:50,c04:40,c03:30', 'type': 'group', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'nofailback': 0, 'group': 'gr-01-02f-03', 'nodes': 'c03:30,c01:40,c02:50', 'type': 'group'}, {'nodes': 'c03,c04,c02', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'group': 'test-gr-02-03f-04', 'type': 'group'}, {'type': 'group', 'nofailback': 0, 'group': 'gr-01f-02-03', 'nodes': 'c01:50,c03:30,c02:40', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'nodes': 'c07:50,c05:30,c06:40', 'group': 'gr-05-06-07f', 'nofailback': 0, 'type': 'group'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c07:40,c06:30,c08:50', 'group': 'gr-06-07-08f', 'nofailback': 0}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'group': 'gr-04-05-06f', 'nofailback': 0, 'nodes': 'c04:30,c05:40,c06:50', 'type': 'group'}, {'type': 'group', 'group': 'gr-02f-03-04', 'nofailback': 0, 'nodes': 'c03:40,c02:50,c04:30', 'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c'}, {'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0, 'type': 'group', 'nodes': 'c04:50,c05:40,c06:30', 'nofailback': 0, 'group': 'gr-04f-05-06'}, {'type': 'group', 'nodes': 'c03:50,c02:40,c01:30', 'nofailback': 0, 'group': 'gr-01-02-03f', 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'restricted': 0}, {'restricted': 0, 'digest': 'b2a74078295215b055c32070d52dd20331af840c', 'group': 'gr-03-04f-05', 'nofailback': 0, 'nodes': 'c03:40,c05:30,c04:50', 'type': 'group'}]}, 'status_code': 200}
HTTP Client async closed
ExtApiAsync aexit
```
</details>

<details>
<summary>src/cluster_tasks/debug_api.py</summary>

```commandline
['c01', 'c02', 'c03', 'c04', 'c05', 'c06', 'c07', 'c08']
{'result': {'data': {'release': '8.3', 'version': '8.3.2', 'repoid': '......'}}, 'status_code': 200}
Waiting for results... of aget_ha_groups
Group: gr-02-03f-04 - c03:50,c02:40,c04:30
Group: gr-03f-04-05 - c05:30,c03:50,c04:40
Group: gr-01f-02-03 - c01:50,c03:30,c02:40
Group: gr-01-02-03f - c01:30,c03:50,c02:40
Group: gr-04f-05-06 - c04:50,c05:40,c06:30
Group: gr-02f-03-04 - c02:50,c03:40,c04:30
Group: gr-01-02f-03 - c01:40,c02:50,c03:30
Group: gr-05-06-07f - c07:50,c06:40,c05:30
Group: gr-03-04f-05 - c04:50,c05:30,c03:40
Group: gr-05-06f-07 - c05:40,c07:30,c06:50
Group: gr-06-07-08f - c06:30,c08:50,c07:40
Group: gr-04-05-06f - c05:40,c06:50,c04:30
Group: gr-06f-07-08 - c06:50,c08:30,c07:40
Group: gr-03-04-05f - c04:40,c05:50,c03:30
Group: gr-04-05f-06 - c05:50,c04:40,c06:30
Group: gr-05f-06-07 - c05:50,c06:40,c07:30
Group: gr-06-07f-08 - c07:50,c06:40,c08:30
Group: gr-02-03-04f - c04:50,c02:30,c03:40
Waiting for results... of tasks: 8
Node: c01, Result: {'kversion': 'Linux 6.8.12-5-pve #1 SMP PREEMPT_DYNAMIC PMX 6.8.12-5 (2024-12-03T10:26Z)', 'cpus': 24, 'cpus_model': 'Intel(R) Xeon(R) CPU E5-2643 v2 @ 3.50GHz', 'memory_total': '62.85 GB', 'uptime': '2 days, 11:05:50'}
Node: c02, Result: {'kversion': 'Linux 6.8.12-5-pve #1 SMP PREEMPT_DYNAMIC PMX 6.8.12-5 (2024-12-03T10:26Z)', 'cpus': 24, 'cpus_model': 'Intel(R) Xeon(R) CPU E5-2643 v2 @ 3.50GHz', 'memory_total': '62.85 GB', 'uptime': '2 days, 11:05:32'}
Node: c03, Result: {}
Node: c04, Result: {'kversion': 'Linux 6.8.12-5-pve #1 SMP PREEMPT_DYNAMIC PMX 6.8.12-5 (2024-12-03T10:26Z)', 'cpus': 24, 'cpus_model': 'Intel(R) Xeon(R) CPU E5-2643 v2 @ 3.50GHz', 'memory_total': '62.85 GB', 'uptime': '2 days, 11:05:45'}
Node: c05, Result: {'kversion': 'Linux 6.8.12-5-pve #1 SMP PREEMPT_DYNAMIC PMX 6.8.12-5 (2024-12-03T10:26Z)', 'cpus': 24, 'cpus_model': 'Intel(R) Xeon(R) CPU E5-2643 v2 @ 3.50GHz', 'memory_total': '62.85 GB', 'uptime': '2 days, 11:05:40'}
Node: c06, Result: {'kversion': 'Linux 6.8.12-5-pve #1 SMP PREEMPT_DYNAMIC PMX 6.8.12-5 (2024-12-03T10:26Z)', 'cpus': 24, 'cpus_model': 'Intel(R) Xeon(R) CPU E5-2643 v2 @ 3.50GHz', 'memory_total': '62.85 GB', 'uptime': '0:04:22'}
Node: c07, Result: {'kversion': 'Linux 6.8.12-5-pve #1 SMP PREEMPT_DYNAMIC PMX 6.8.12-5 (2024-12-03T10:26Z)', 'cpus': 24, 'cpus_model': 'Intel(R) Xeon(R) CPU E5-2643 v2 @ 3.50GHz', 'memory_total': '125.85 GB', 'uptime': '2 days, 11:05:37'}
Node: c08, Result: {'kversion': 'Linux 6.8.12-5-pve #1 SMP PREEMPT_DYNAMIC PMX 6.8.12-5 (2024-12-03T10:26Z)', 'cpus': 24, 'cpus_model': 'Intel(R) Xeon(R) CPU E5-2643 v2 @ 3.50GHz', 'memory_total': '125.85 GB', 'uptime': '2 days, 11:05:32'}
```
</details>
